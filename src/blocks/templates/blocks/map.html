{% load wagtailcore_tags %}
{% block extra_css %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.1.0/dist/leaflet.css" integrity="sha512-wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw==" crossorigin=""/>
{% endblock %}

<div id="map-{{id}}" style="height: {{ value.height }}px;">
</div>

{% block extra_js %}
<script src="https://unpkg.com/leaflet@1.1.0/dist/leaflet.js" integrity="sha512-mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA==" crossorigin=""></script>
<script>
 var mymap = L.map('map-{{id}}').setView([{{ value.location }}], 13);
 L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
   attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
   maxZoom: 18,
   id: 'mapbox.streets',
   accessToken: 'pk.eyJ1IjoidXRua2FyIiwiYSI6ImNqNTJrNzF2eTBjNGszMm85bXNiZmFmdHUifQ.FzoCR3MjIP09-4iSw42Vkw'
 }).addTo(mymap);
 
 {% for marker in value.markers %}
 L.marker([{{ marker.marker_location }}]).addTo(mymap).bindPopup('{{ marker.marker_description }}').openPopup();
 {% endfor %}

 {% for line in value.lines %}
 L.polyline(
   [
     [{{ line.start }}],
     {% for point in line.points %}
     [{{ point }}],
     {% endfor %}
     [{{ line.end }}]
   ]
 ).addTo(mymap);
 {% endfor %}
 
</script>
{% endblock %}
